<div id="deleteModal" class="hidden fixed inset-0 z-50 w-full flex items-center justify-center bg-gray-800 bg-opacity-50">
  <div class="bg-white rounded-lg shadow-lg max-w-md w-full p-6">
    <h3 class="text-lg font-semibold text-gray-900">Confirm Deletion</h3>
    <p id="delete-confirmation-text" class="mt-2 text-sm text-gray-600">Are you sure you want to delete this product?</p>
    <div class="mt-6 flex justify-end space-x-3">
      <button type="button" onclick="hideDeleteModal()" class="px-4 py-2 bg-white border border-gray-300 rounded-md text-sm font-medium text-gray-700 hover:bg-gray-50">Cancel</button>
      <button id="confirmDeleteButton" type="button" class="px-4 py-2 bg-red-600 border border-transparent rounded-md text-sm font-medium text-white hover:bg-red-700">Delete</button>
    </div>
  </div>
</div>

<script>
  const deleteModal = document.getElementById('deleteModal');
  const confirmDeleteButton = document.getElementById('confirmDeleteButton');
  const deleteConfirmationText = document.getElementById('delete-confirmation-text');

  function showDeleteModal() { deleteModal.classList.remove('hidden'); }
  function hideDeleteModal() { deleteModal.classList.add('hidden'); }

  function openDeleteModal(productId, productName) {
    confirmDeleteButton.dataset.productId = productId;
    deleteConfirmationText.textContent = `Are you sure you want to delete "${productName}"? This action cannot be undone.`;
    showDeleteModal();
  }

  async function confirmDelete() {
    const productId = confirmDeleteButton.dataset.productId;
    if (!productId) return;

    const deleteUrl = `{% url 'main:delete_product_ajax' '00000000-0000-0000-0000-000000000000' %}`.replace('00000000-0000-0000-0000-000000000000', productId);
    const response = await fetch(deleteUrl, { method: "POST" });

    hideDeleteModal();

    if (response.ok) {
      showToast('Product deleted...', '', 'error');
      document.dispatchEvent(new CustomEvent('productDataChanged'));
    }
  }

  confirmDeleteButton.addEventListener('click', confirmDelete);
</script>